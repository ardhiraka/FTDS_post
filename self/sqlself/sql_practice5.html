
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Pivoting Data in SQL &#8212; FTDS Post Study Materials</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet">
  <link href="../../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Tableau" href="../tableau/tableau.html" />
    <link rel="prev" title="Statistic Descriptive in SQL" href="sql_practice4.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">FTDS Post Study Materials</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../intro.html">
   Hacktiv8 Data Science Fulltime Program Post Study Materials
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Wiki
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../wiki/business/business.html">
   Business Accumen
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../wiki/business/term.html">
     Terminologies
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../wiki/sql/sql_intro.html">
   SQL
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../wiki/sql/sql_term.html">
     Terminologies
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../wiki/sql/sql_ddl.html">
     DDL
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../wiki/sql/sql_dml.html">
     DML
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Self Learning
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="sqlself.html">
   SQL
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="sql_practice1.html">
     SQLite Practice 1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="sql_practice2.html">
     MySQL Practice 2
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="sql_practice3.html">
     MySQL Practice 3
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="sql_practice4.html">
     Statistic Descriptive in SQL
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Pivoting Data in SQL
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../tableau/tableau.html">
   Tableau
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../tableau/intro1.html">
     Tableau Introduction
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tableau/intro2.html">
     Tableau Dashboard
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tableau/intro3.html">
     Tableau Dashboard Practice
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Job-Related Prep
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../job/DA/da_intro.html">
   Data Analyst
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../job/DA/da1.html">
     References
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  References
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../refs.html">
   References
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/self/sqlself/sql_practice5.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/docs/self/sqlself/sql_practice5.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#setup">
   Setup
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#pivot-table">
   Pivot Table
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#sql-with-python">
   SQL with Python
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#install-mysql-driver">
     Install MySQL Driver
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#test-mysql-connector">
     Test MySQL Connector
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#python-mysql-example">
     Python MySQL Example
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Pivoting Data in SQL</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#setup">
   Setup
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#pivot-table">
   Pivot Table
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#sql-with-python">
   SQL with Python
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#install-mysql-driver">
     Install MySQL Driver
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#test-mysql-connector">
     Test MySQL Connector
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#python-mysql-example">
     Python MySQL Example
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="pivoting-data-in-sql">
<h1>Pivoting Data in SQL<a class="headerlink" href="#pivoting-data-in-sql" title="Permalink to this headline">¶</a></h1>
<div class="section" id="setup">
<h2>Setup<a class="headerlink" href="#setup" title="Permalink to this headline">¶</a></h2>
<ol class="simple">
<li><p>Start by installing MySQL from here: https://dev.mysql.com/downloads/</p></li>
<li><p>Follow the instructions from <a class="reference external" href="https://ladvien.com/data-analytics-mysql-localhost-setup/">here</a> to setup MySQL on your local machine.</p></li>
<li><p>Install MySQL Workbench from here: https://dev.mysql.com/downloads/workbench/</p></li>
<li><p>Download dataset used in this lecture from here: https://github.com/ardhiraka/PFDS_sources/blob/master/players.csv and https://github.com/ardhiraka/PFDS_sources/blob/master/teams.csv</p></li>
</ol>
</div>
<div class="section" id="pivot-table">
<h2>Pivot Table<a class="headerlink" href="#pivot-table" title="Permalink to this headline">¶</a></h2>
<p>Let’s start by aggregating the data to show the number of players of each year in each conference, similar to the first example in the inner join lesson:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span> <span class="n">teams</span><span class="p">.</span><span class="n">conference</span> <span class="k">AS</span> <span class="n">conference</span><span class="p">,</span>
       <span class="n">players</span><span class="p">.</span><span class="k">year</span><span class="p">,</span>
       <span class="k">COUNT</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="k">AS</span> <span class="n">players</span>
  <span class="k">FROM</span> <span class="n">hacktiv8</span><span class="p">.</span><span class="n">players</span> <span class="n">players</span>
  <span class="k">JOIN</span> <span class="n">hacktiv8</span><span class="p">.</span><span class="n">teams</span> <span class="n">teams</span>
    <span class="k">ON</span> <span class="n">teams</span><span class="p">.</span><span class="n">school_name</span> <span class="o">=</span> <span class="n">players</span><span class="p">.</span><span class="n">school_name</span>
 <span class="k">GROUP</span> <span class="k">BY</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span>
 <span class="k">ORDER</span> <span class="k">BY</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span>
</pre></div>
</div>
<p>In order to transform the data, we’ll need to put the above query into a subquery. It can be helpful to create the subquery and select all columns from it before starting to make transformations. Re-running the query at incremental steps like this makes it easier to debug if your query doesn’t run. Note that you can eliminate the ORDER BY clause from the subquery since we’ll reorder the results in the outer query.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span> <span class="o">*</span>
  <span class="k">FROM</span> <span class="p">(</span>
        <span class="k">SELECT</span> <span class="n">teams</span><span class="p">.</span><span class="n">conference</span> <span class="k">AS</span> <span class="n">conference</span><span class="p">,</span>
               <span class="n">players</span><span class="p">.</span><span class="k">year</span><span class="p">,</span>
               <span class="k">COUNT</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="k">AS</span> <span class="n">players</span>
            <span class="k">FROM</span> <span class="n">hacktiv8</span><span class="p">.</span><span class="n">players</span> <span class="n">players</span>
			<span class="k">JOIN</span> <span class="n">hacktiv8</span><span class="p">.</span><span class="n">teams</span> <span class="n">teams</span>
            <span class="k">ON</span> <span class="n">teams</span><span class="p">.</span><span class="n">school_name</span> <span class="o">=</span> <span class="n">players</span><span class="p">.</span><span class="n">school_name</span>
         <span class="k">GROUP</span> <span class="k">BY</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span>
       <span class="p">)</span> <span class="n">sub</span>
</pre></div>
</div>
<p>Assuming that works as planned (results should look exactly the same as the first query), it’s time to break the results out into different columns for various years. Each item in the SELECT statement creates a column, so you’ll have to create a separate column for each year:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span> <span class="n">conference</span><span class="p">,</span>
       <span class="k">SUM</span><span class="p">(</span><span class="k">CASE</span> <span class="k">WHEN</span> <span class="k">year</span> <span class="o">=</span> <span class="s1">&#39;FR&#39;</span> <span class="k">THEN</span> <span class="n">players</span> <span class="k">ELSE</span> <span class="k">NULL</span> <span class="k">END</span><span class="p">)</span> <span class="k">AS</span> <span class="n">fr</span><span class="p">,</span>
       <span class="k">SUM</span><span class="p">(</span><span class="k">CASE</span> <span class="k">WHEN</span> <span class="k">year</span> <span class="o">=</span> <span class="s1">&#39;SO&#39;</span> <span class="k">THEN</span> <span class="n">players</span> <span class="k">ELSE</span> <span class="k">NULL</span> <span class="k">END</span><span class="p">)</span> <span class="k">AS</span> <span class="n">so</span><span class="p">,</span>
       <span class="k">SUM</span><span class="p">(</span><span class="k">CASE</span> <span class="k">WHEN</span> <span class="k">year</span> <span class="o">=</span> <span class="s1">&#39;JR&#39;</span> <span class="k">THEN</span> <span class="n">players</span> <span class="k">ELSE</span> <span class="k">NULL</span> <span class="k">END</span><span class="p">)</span> <span class="k">AS</span> <span class="n">jr</span><span class="p">,</span>
       <span class="k">SUM</span><span class="p">(</span><span class="k">CASE</span> <span class="k">WHEN</span> <span class="k">year</span> <span class="o">=</span> <span class="s1">&#39;SR&#39;</span> <span class="k">THEN</span> <span class="n">players</span> <span class="k">ELSE</span> <span class="k">NULL</span> <span class="k">END</span><span class="p">)</span> <span class="k">AS</span> <span class="n">sr</span>
  <span class="k">FROM</span> <span class="p">(</span>
        <span class="k">SELECT</span> <span class="n">teams</span><span class="p">.</span><span class="n">conference</span> <span class="k">AS</span> <span class="n">conference</span><span class="p">,</span>
               <span class="n">players</span><span class="p">.</span><span class="k">year</span><span class="p">,</span>
               <span class="k">COUNT</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="k">AS</span> <span class="n">players</span>
          <span class="k">FROM</span> <span class="n">hacktiv8</span><span class="p">.</span><span class="n">players</span> <span class="n">players</span>
          <span class="k">JOIN</span> <span class="n">hacktiv8</span><span class="p">.</span><span class="n">teams</span> <span class="n">teams</span>
            <span class="k">ON</span> <span class="n">teams</span><span class="p">.</span><span class="n">school_name</span> <span class="o">=</span> <span class="n">players</span><span class="p">.</span><span class="n">school_name</span>
         <span class="k">GROUP</span> <span class="k">BY</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span>
       <span class="p">)</span> <span class="n">sub</span>
 <span class="k">GROUP</span> <span class="k">BY</span> <span class="mi">1</span>
 <span class="k">ORDER</span> <span class="k">BY</span> <span class="mi">1</span>
</pre></div>
</div>
<p>But this could still be made a little better. You’ll notice that the above query produces a list that is ordered alphabetically by Conference. It might make more sense to add a “total players” column and order by that (largest to smallest):</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span> <span class="n">conference</span><span class="p">,</span>
       <span class="k">SUM</span><span class="p">(</span><span class="n">players</span><span class="p">)</span> <span class="k">AS</span> <span class="n">total_players</span><span class="p">,</span>
       <span class="k">SUM</span><span class="p">(</span><span class="k">CASE</span> <span class="k">WHEN</span> <span class="k">year</span> <span class="o">=</span> <span class="s1">&#39;FR&#39;</span> <span class="k">THEN</span> <span class="n">players</span> <span class="k">ELSE</span> <span class="k">NULL</span> <span class="k">END</span><span class="p">)</span> <span class="k">AS</span> <span class="n">fr</span><span class="p">,</span>
       <span class="k">SUM</span><span class="p">(</span><span class="k">CASE</span> <span class="k">WHEN</span> <span class="k">year</span> <span class="o">=</span> <span class="s1">&#39;SO&#39;</span> <span class="k">THEN</span> <span class="n">players</span> <span class="k">ELSE</span> <span class="k">NULL</span> <span class="k">END</span><span class="p">)</span> <span class="k">AS</span> <span class="n">so</span><span class="p">,</span>
       <span class="k">SUM</span><span class="p">(</span><span class="k">CASE</span> <span class="k">WHEN</span> <span class="k">year</span> <span class="o">=</span> <span class="s1">&#39;JR&#39;</span> <span class="k">THEN</span> <span class="n">players</span> <span class="k">ELSE</span> <span class="k">NULL</span> <span class="k">END</span><span class="p">)</span> <span class="k">AS</span> <span class="n">jr</span><span class="p">,</span>
       <span class="k">SUM</span><span class="p">(</span><span class="k">CASE</span> <span class="k">WHEN</span> <span class="k">year</span> <span class="o">=</span> <span class="s1">&#39;SR&#39;</span> <span class="k">THEN</span> <span class="n">players</span> <span class="k">ELSE</span> <span class="k">NULL</span> <span class="k">END</span><span class="p">)</span> <span class="k">AS</span> <span class="n">sr</span>
  <span class="k">FROM</span> <span class="p">(</span>
        <span class="k">SELECT</span> <span class="n">teams</span><span class="p">.</span><span class="n">conference</span> <span class="k">AS</span> <span class="n">conference</span><span class="p">,</span>
               <span class="n">players</span><span class="p">.</span><span class="k">year</span><span class="p">,</span>
               <span class="k">COUNT</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="k">AS</span> <span class="n">players</span>
          <span class="k">FROM</span> <span class="n">hacktiv8</span><span class="p">.</span><span class="n">players</span> <span class="n">players</span>
          <span class="k">JOIN</span> <span class="n">hacktiv8</span><span class="p">.</span><span class="n">teams</span> <span class="n">teams</span>
            <span class="k">ON</span> <span class="n">teams</span><span class="p">.</span><span class="n">school_name</span> <span class="o">=</span> <span class="n">players</span><span class="p">.</span><span class="n">school_name</span>
         <span class="k">GROUP</span> <span class="k">BY</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span>
       <span class="p">)</span> <span class="n">sub</span>
 <span class="k">GROUP</span> <span class="k">BY</span> <span class="mi">1</span>
 <span class="k">ORDER</span> <span class="k">BY</span> <span class="mi">2</span> <span class="k">DESC</span>
</pre></div>
</div>
</div>
<div class="section" id="sql-with-python">
<h2>SQL with Python<a class="headerlink" href="#sql-with-python" title="Permalink to this headline">¶</a></h2>
<div class="section" id="install-mysql-driver">
<h3>Install MySQL Driver<a class="headerlink" href="#install-mysql-driver" title="Permalink to this headline">¶</a></h3>
<p>If you want to use Python, you need to install mysql-connector first with <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">-q</span> <span class="pre">mysql-connector-python</span></code></p>
</div>
<div class="section" id="test-mysql-connector">
<h3>Test MySQL Connector<a class="headerlink" href="#test-mysql-connector" title="Permalink to this headline">¶</a></h3>
<p>Below are the example commands to use MySQL with Python directly.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">mysql.connector</span>

<span class="n">cnx</span> <span class="o">=</span> <span class="n">mysql</span><span class="o">.</span><span class="n">connector</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
    <span class="n">user</span><span class="o">=</span><span class="s1">&#39;root&#39;</span><span class="p">,</span> 
    <span class="n">password</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
    <span class="n">host</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># get cursor from connection</span>
<span class="n">cur</span> <span class="o">=</span> <span class="n">cnx</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>

<span class="c1"># Query to execute</span>

<span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;select * </span>
<span class="s2">from hacktiv8.players</span>
<span class="s2">limit 5&quot;&quot;&quot;</span>

<span class="c1">#  execute this query </span>
<span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>

<span class="c1"># get rows</span>
<span class="n">rows</span>  <span class="o">=</span> <span class="n">cur</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&#39;Cincinnati Bearcats&#39;, &#39;Cincinnati&#39;, &#39;Ralph Abernathy&#39;, &#39;RB&#39;, 67.0, 161.0, &#39;JR&#39;, &#39;ATLANTA, GA&#39;, &#39;GA&#39;, 1)
(&#39;Cincinnati Bearcats&#39;, &#39;Cincinnati&#39;, &#39;Mekale McKay&#39;, &#39;WR&#39;, 78.0, 195.0, &#39;SO&#39;, &#39;LOUISVILLE, KY&#39;, &#39;KY&#39;, 2)
(&#39;Cincinnati Bearcats&#39;, &#39;Cincinnati&#39;, &#39;Trenier Orr&#39;, &#39;CB&#39;, 71.0, 177.0, &#39;SO&#39;, &#39;WINTER GARDEN, FL&#39;, &#39;FL&#39;, 3)
(&#39;Cincinnati Bearcats&#39;, &#39;Cincinnati&#39;, &#39;Bennie Coney&#39;, &#39;QB&#39;, 75.0, 216.0, &#39;FR&#39;, &#39;PLANT CITY, FL&#39;, &#39;FL&#39;, 4)
(&#39;Cincinnati Bearcats&#39;, &#39;Cincinnati&#39;, &#39;Johnny Holton&#39;, &#39;WR&#39;, 75.0, 190.0, &#39;JR&#39;, &#39;MIAMI, FL&#39;, &#39;FL&#39;, 5)
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="python-mysql-example">
<h3>Python MySQL Example<a class="headerlink" href="#python-mysql-example" title="Permalink to this headline">¶</a></h3>
<p>Now let’s move to Python. First we are going to make <code class="docutils literal notranslate"><span class="pre">connect.py</span></code> file to test the connection.</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">mysql.connector</span>

<span class="n">db</span> <span class="o">=</span> <span class="n">mysql</span><span class="o">.</span><span class="n">connector</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
  <span class="n">host</span><span class="o">=</span><span class="s2">&quot;localhost&quot;</span><span class="p">,</span>
  <span class="n">user</span><span class="o">=</span><span class="s2">&quot;root&quot;</span><span class="p">,</span>
  <span class="n">passwd</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
<span class="p">)</span>

<span class="k">if</span> <span class="n">db</span><span class="o">.</span><span class="n">is_connected</span><span class="p">():</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Successfully connected to MySQL database&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Try running the above code and see if you can connect to MySQL with <code class="docutils literal notranslate"><span class="pre">python3</span> <span class="pre">connect.py</span></code>.</p>
<p>Now let’s make some database, tables, values to start with. Make new file <code class="docutils literal notranslate"><span class="pre">create_db.py</span></code> and run it.</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">mysql.connector</span>

<span class="n">db</span> <span class="o">=</span> <span class="n">mysql</span><span class="o">.</span><span class="n">connector</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
  <span class="n">host</span><span class="o">=</span><span class="s2">&quot;localhost&quot;</span><span class="p">,</span>
  <span class="n">user</span><span class="o">=</span><span class="s2">&quot;root&quot;</span><span class="p">,</span>
  <span class="n">passwd</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
<span class="p">)</span>

<span class="n">cursor</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
<span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;CREATE DATABASE ftds&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Database Successfully Created&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>To check if the database is created, you can open your MySQL Workbench and select the database <code class="docutils literal notranslate"><span class="pre">ftds</span></code>.</p>
<p>Then you can create tables and insert values.</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">mysql.connector</span>

<span class="n">db</span> <span class="o">=</span> <span class="n">mysql</span><span class="o">.</span><span class="n">connector</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
  <span class="n">host</span><span class="o">=</span><span class="s2">&quot;localhost&quot;</span><span class="p">,</span>
  <span class="n">user</span><span class="o">=</span><span class="s2">&quot;root&quot;</span><span class="p">,</span>
  <span class="n">passwd</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
  <span class="n">database</span><span class="o">=</span><span class="s2">&quot;ftds&quot;</span>
<span class="p">)</span>

<span class="n">cursor</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
<span class="n">sql</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;CREATE TABLE student (</span>
<span class="s2">  student_id INT AUTO_INCREMENT PRIMARY KEY,</span>
<span class="s2">  name VARCHAR(255),</span>
<span class="s2">  address Varchar(255)</span>
<span class="s2">)</span>
<span class="s2">&quot;&quot;&quot;</span>
<span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">sql</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Student Table Successfully Created&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Save with <code class="docutils literal notranslate"><span class="pre">create_table.py</span></code> and run it.</p>
<p>Insert one values into the table, save with <code class="docutils literal notranslate"><span class="pre">insert_one.py</span></code>.</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">mysql.connector</span>

<span class="n">db</span> <span class="o">=</span> <span class="n">mysql</span><span class="o">.</span><span class="n">connector</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
  <span class="n">host</span><span class="o">=</span><span class="s2">&quot;localhost&quot;</span><span class="p">,</span>
  <span class="n">user</span><span class="o">=</span><span class="s2">&quot;root&quot;</span><span class="p">,</span>
  <span class="n">passwd</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
  <span class="n">database</span><span class="o">=</span><span class="s2">&quot;ftds&quot;</span>
<span class="p">)</span>

<span class="n">cursor</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
<span class="n">sql</span> <span class="o">=</span> <span class="s2">&quot;INSERT INTO student (name, address) VALUES (</span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">)&quot;</span>
<span class="n">val</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;Raka&quot;</span><span class="p">,</span> <span class="s2">&quot;Semarang&quot;</span><span class="p">)</span>
<span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>

<span class="n">db</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> data added &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cursor</span><span class="o">.</span><span class="n">rowcount</span><span class="p">))</span>
</pre></div>
</div>
<p>Look at the code we use to insert one value.</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">sql</span> <span class="o">=</span> <span class="s2">&quot;INSERT INTO student (name, address) VALUES (</span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">)&quot;</span>
<span class="n">val</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;Raka&quot;</span><span class="p">,</span> <span class="s2">&quot;Semarang&quot;</span><span class="p">)</span>
<span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>

<span class="n">db</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</pre></div>
</div>
<p>We use <code class="docutils literal notranslate"><span class="pre">%s</span></code> to indicate that we are passing in a string. Never use <code class="docutils literal notranslate"><span class="pre">sql</span> <span class="pre">=</span> <span class="pre">&quot;INSERT</span> <span class="pre">INTO</span> <span class="pre">customers</span> <span class="pre">(name,</span> <span class="pre">address)</span> <span class="pre">VALUES</span> <span class="pre">('&quot;+</span> <span class="pre">name</span> <span class="pre">+&quot;',</span> <span class="pre">'&quot;</span> <span class="pre">+</span> <span class="pre">address</span> <span class="pre">+&quot;')&quot;</span></code> to avoid SQL Injection.
Finally we use db.commit() to commit the changes to the database. This method usually used when we need to insert, update, or delete data. But how about if we need to insert multiple data at once? Let’s make <code class="docutils literal notranslate"><span class="pre">insert_many.py</span></code> file and run it.</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">mysql.connector</span>

<span class="n">db</span> <span class="o">=</span> <span class="n">mysql</span><span class="o">.</span><span class="n">connector</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
  <span class="n">host</span><span class="o">=</span><span class="s2">&quot;localhost&quot;</span><span class="p">,</span>
  <span class="n">user</span><span class="o">=</span><span class="s2">&quot;root&quot;</span><span class="p">,</span>
  <span class="n">passwd</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
  <span class="n">database</span><span class="o">=</span><span class="s2">&quot;ftds&quot;</span>
<span class="p">)</span>

<span class="n">cursor</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
<span class="n">sql</span> <span class="o">=</span> <span class="s2">&quot;INSERT INTO customers (name, address) VALUES (</span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">)&quot;</span>
<span class="n">values</span> <span class="o">=</span> <span class="p">[</span>
  <span class="p">(</span><span class="s2">&quot;Danu&quot;</span><span class="p">,</span> <span class="s2">&quot;Jakarta&quot;</span><span class="p">),</span>
  <span class="p">(</span><span class="s2">&quot;Fahmi&quot;</span><span class="p">,</span> <span class="s2">&quot;Surabaya&quot;</span><span class="p">),</span>
  <span class="p">(</span><span class="s2">&quot;Sardi&quot;</span><span class="p">,</span> <span class="s2">&quot;Bandung&quot;</span><span class="p">),</span>
  <span class="p">(</span><span class="s2">&quot;Hana&quot;</span><span class="p">,</span> <span class="s2">&quot;Depok&quot;</span><span class="p">)</span>
<span class="p">]</span>

<span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">values</span><span class="p">:</span>
  <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>
  <span class="n">db</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> data added&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">)))</span>
</pre></div>
</div>
<p>We can show data from the table with <code class="docutils literal notranslate"><span class="pre">select_all.py</span></code> file and run it.</p>
<p>We can use <code class="docutils literal notranslate"><span class="pre">fetchall()</span></code> to get all data from the table, <code class="docutils literal notranslate"><span class="pre">fetchone()</span></code> to get one data from the table, and <code class="docutils literal notranslate"><span class="pre">fetchmany()</span></code> to get multiple data from the table.</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">mysql.connector</span>

<span class="n">db</span> <span class="o">=</span> <span class="n">mysql</span><span class="o">.</span><span class="n">connector</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
  <span class="n">host</span><span class="o">=</span><span class="s2">&quot;localhost&quot;</span><span class="p">,</span>
  <span class="n">user</span><span class="o">=</span><span class="s2">&quot;root&quot;</span><span class="p">,</span>
  <span class="n">passwd</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
  <span class="n">database</span><span class="o">=</span><span class="s2">&quot;ftds&quot;</span>
<span class="p">)</span>

<span class="n">cursor</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
<span class="n">sql</span> <span class="o">=</span> <span class="s2">&quot;SELECT * FROM student&quot;</span>
<span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">sql</span><span class="p">)</span>

<span class="n">results</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>

<span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
  <span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<p>Next we want to try to use <code class="docutils literal notranslate"><span class="pre">fetchoone()</span></code> to get one data from the table, with <code class="docutils literal notranslate"><span class="pre">select_one.py</span></code> file and run it.</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">mysql.connector</span>

<span class="n">db</span> <span class="o">=</span> <span class="n">mysql</span><span class="o">.</span><span class="n">connector</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
  <span class="n">host</span><span class="o">=</span><span class="s2">&quot;localhost&quot;</span><span class="p">,</span>
  <span class="n">user</span><span class="o">=</span><span class="s2">&quot;root&quot;</span><span class="p">,</span>
  <span class="n">passwd</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
  <span class="n">database</span><span class="o">=</span><span class="s2">&quot;ftds&quot;</span>
<span class="p">)</span>

<span class="n">cursor</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
<span class="n">sql</span> <span class="o">=</span> <span class="s2">&quot;SELECT * FROM student&quot;</span>
<span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">sql</span><span class="p">)</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
<p>Let’s try update data with <code class="docutils literal notranslate"><span class="pre">update_one.py</span></code> file and run it.</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">mysql.connector</span>

<span class="n">db</span> <span class="o">=</span> <span class="n">mysql</span><span class="o">.</span><span class="n">connector</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
  <span class="n">host</span><span class="o">=</span><span class="s2">&quot;localhost&quot;</span><span class="p">,</span>
  <span class="n">user</span><span class="o">=</span><span class="s2">&quot;root&quot;</span><span class="p">,</span>
  <span class="n">passwd</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
  <span class="n">database</span><span class="o">=</span><span class="s2">&quot;ftds&quot;</span>
<span class="p">)</span>

<span class="n">cursor</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
<span class="n">sql</span> <span class="o">=</span> <span class="s2">&quot;UPDATE student SET name=</span><span class="si">%s</span><span class="s2">, address=</span><span class="si">%s</span><span class="s2"> WHERE student_id=</span><span class="si">%s</span><span class="s2">&quot;</span>
<span class="n">val</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;Rachman&quot;</span><span class="p">,</span> <span class="s2">&quot;Lombok&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>

<span class="n">db</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> data updated&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cursor</span><span class="o">.</span><span class="n">rowcount</span><span class="p">))</span>
</pre></div>
</div>
<p>We give new value to the data with <code class="docutils literal notranslate"><span class="pre">student_id</span></code> = 1.</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<p>We can use <code class="docutils literal notranslate"><span class="pre">delete_one.py</span></code> file and run it.</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">mysql.connector</span>

<span class="n">db</span> <span class="o">=</span> <span class="n">mysql</span><span class="o">.</span><span class="n">connector</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
  <span class="n">host</span><span class="o">=</span><span class="s2">&quot;localhost&quot;</span><span class="p">,</span>
  <span class="n">user</span><span class="o">=</span><span class="s2">&quot;root&quot;</span><span class="p">,</span>
  <span class="n">passwd</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
  <span class="n">database</span><span class="o">=</span><span class="s2">&quot;ftds&quot;</span>
<span class="p">)</span>

<span class="n">cursor</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
<span class="n">sql</span> <span class="o">=</span> <span class="s2">&quot;DELETE FROM student WHERE student_id=</span><span class="si">%s</span><span class="s2">&quot;</span>
<span class="n">val</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">)</span>
<span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>

<span class="n">db</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> data deleted&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cursor</span><span class="o">.</span><span class="n">rowcount</span><span class="p">))</span>
</pre></div>
</div>
<p>Finally we can combine everything we have learned in this session with <code class="docutils literal notranslate"><span class="pre">py_sql.py</span></code> file and run it.</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">mysql.connector</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="n">db</span> <span class="o">=</span> <span class="n">mysql</span><span class="o">.</span><span class="n">connector</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
  <span class="n">host</span><span class="o">=</span><span class="s2">&quot;localhost&quot;</span><span class="p">,</span>
  <span class="n">user</span><span class="o">=</span><span class="s2">&quot;root&quot;</span><span class="p">,</span>
  <span class="n">passwd</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
  <span class="n">database</span><span class="o">=</span><span class="s2">&quot;ftds&quot;</span>
<span class="p">)</span>


<span class="k">def</span> <span class="nf">insert_data</span><span class="p">(</span><span class="n">db</span><span class="p">):</span>
  <span class="n">name</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Name: &quot;</span><span class="p">)</span>
  <span class="n">address</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Address: &quot;</span><span class="p">)</span>
  <span class="n">val</span> <span class="o">=</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">address</span><span class="p">)</span>
  <span class="n">cursor</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
  <span class="n">sql</span> <span class="o">=</span> <span class="s2">&quot;INSERT INTO student (name, address) VALUES (</span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">)&quot;</span>
  <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>
  <span class="n">db</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> data added&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cursor</span><span class="o">.</span><span class="n">rowcount</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">show_data</span><span class="p">(</span><span class="n">db</span><span class="p">):</span>
  <span class="n">cursor</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
  <span class="n">sql</span> <span class="o">=</span> <span class="s2">&quot;SELECT * FROM student&quot;</span>
  <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">sql</span><span class="p">)</span>
  <span class="n">results</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
  
  <span class="k">if</span> <span class="n">cursor</span><span class="o">.</span><span class="n">rowcount</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No data&quot;</span><span class="p">)</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
      <span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">update_data</span><span class="p">(</span><span class="n">db</span><span class="p">):</span>
  <span class="n">cursor</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
  <span class="n">show_data</span><span class="p">(</span><span class="n">db</span><span class="p">)</span>
  <span class="n">student_id</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Select student id&gt; &quot;</span><span class="p">)</span>
  <span class="n">name</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;New Name: &quot;</span><span class="p">)</span>
  <span class="n">address</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;New Address: &quot;</span><span class="p">)</span>

  <span class="n">sql</span> <span class="o">=</span> <span class="s2">&quot;UPDATE student SET name=</span><span class="si">%s</span><span class="s2">, address=</span><span class="si">%s</span><span class="s2"> WHERE student_id=</span><span class="si">%s</span><span class="s2">&quot;</span>
  <span class="n">val</span> <span class="o">=</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="n">student_id</span><span class="p">)</span>
  <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>
  <span class="n">db</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> data changed&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cursor</span><span class="o">.</span><span class="n">rowcount</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">delete_data</span><span class="p">(</span><span class="n">db</span><span class="p">):</span>
  <span class="n">cursor</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
  <span class="n">show_data</span><span class="p">(</span><span class="n">db</span><span class="p">)</span>
  <span class="n">student_id</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Select student id&gt; &quot;</span><span class="p">)</span>
  <span class="n">sql</span> <span class="o">=</span> <span class="s2">&quot;DELETE FROM student WHERE student_id=</span><span class="si">%s</span><span class="s2">&quot;</span>
  <span class="n">val</span> <span class="o">=</span> <span class="p">(</span><span class="n">student_id</span><span class="p">,)</span>
  <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>
  <span class="n">db</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> data deleted&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cursor</span><span class="o">.</span><span class="n">rowcount</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">search_data</span><span class="p">(</span><span class="n">db</span><span class="p">):</span>
  <span class="n">cursor</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
  <span class="n">keyword</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Keyword: &quot;</span><span class="p">)</span>
  <span class="n">sql</span> <span class="o">=</span> <span class="s2">&quot;SELECT * FROM student WHERE name LIKE </span><span class="si">%s</span><span class="s2"> OR address LIKE </span><span class="si">%s</span><span class="s2">&quot;</span>
  <span class="n">val</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;%</span><span class="si">{}</span><span class="s2">%&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">keyword</span><span class="p">),</span> <span class="s2">&quot;%</span><span class="si">{}</span><span class="s2">%&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">keyword</span><span class="p">))</span>
  <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>
  <span class="n">results</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
  
  <span class="k">if</span> <span class="n">cursor</span><span class="o">.</span><span class="n">rowcount</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No Data&quot;</span><span class="p">)</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
      <span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">show_menu</span><span class="p">(</span><span class="n">db</span><span class="p">):</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=== H8 Py MySQL Exercise ===&quot;</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;1. Insert Data&quot;</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;2. Show Data&quot;</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;3. Update Data&quot;</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;4. Delete Data&quot;</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;5. Search Data&quot;</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;0. Exit&quot;</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;------------------&quot;</span><span class="p">)</span>
  <span class="n">menu</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Select menu&gt; &quot;</span><span class="p">)</span>

  <span class="c1">#clear screen</span>
  <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;clear&quot;</span><span class="p">)</span>

  <span class="k">if</span> <span class="n">menu</span> <span class="o">==</span> <span class="s2">&quot;1&quot;</span><span class="p">:</span>
    <span class="n">insert_data</span><span class="p">(</span><span class="n">db</span><span class="p">)</span>
  <span class="k">elif</span> <span class="n">menu</span> <span class="o">==</span> <span class="s2">&quot;2&quot;</span><span class="p">:</span>
    <span class="n">show_data</span><span class="p">(</span><span class="n">db</span><span class="p">)</span>
  <span class="k">elif</span> <span class="n">menu</span> <span class="o">==</span> <span class="s2">&quot;3&quot;</span><span class="p">:</span>
    <span class="n">update_data</span><span class="p">(</span><span class="n">db</span><span class="p">)</span>
  <span class="k">elif</span> <span class="n">menu</span> <span class="o">==</span> <span class="s2">&quot;4&quot;</span><span class="p">:</span>
    <span class="n">delete_data</span><span class="p">(</span><span class="n">db</span><span class="p">)</span>
  <span class="k">elif</span> <span class="n">menu</span> <span class="o">==</span> <span class="s2">&quot;5&quot;</span><span class="p">:</span>
    <span class="n">search_data</span><span class="p">(</span><span class="n">db</span><span class="p">)</span>
  <span class="k">elif</span> <span class="n">menu</span> <span class="o">==</span> <span class="s2">&quot;0&quot;</span><span class="p">:</span>
    <span class="n">exit</span><span class="p">()</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Wrong Input&quot;</span><span class="p">)</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
  <span class="k">while</span><span class="p">(</span><span class="kc">True</span><span class="p">):</span>
    <span class="n">show_menu</span><span class="p">(</span><span class="n">db</span><span class="p">)</span>
</pre></div>
</div>
<p>Full code here https://github.com/ardhiraka/FTDS_post/tree/master/py_sql</p>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./self\sqlself"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="sql_practice4.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Statistic Descriptive in SQL</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../tableau/tableau.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Tableau</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By FTDS Curriculum Team<br/>
    
        &copy; Copyright 2022.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>